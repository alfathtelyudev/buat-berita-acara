<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Pembuatan Berita Acara LDK Al-Fath 2024</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css" rel="stylesheet">

    <style>
        .whitespace-pre-line {
            white-space: pre-line;
        }

        body {
            background-image: url('./Gambar\ WhatsApp\ 2024-08-10\ pukul\ 15.02.32_8eb8f000.jpg');
            background-attachment: fixed;
            background-position: center;
            background-repeat: no-repeat;
            background-size: auto;
              /* font-family: 'Poppins', sans-serif; */

        }

        .bg-slightly-transparent {
            /* bacmround with image, and repeat */

            background-image: url('./bg.png');
            background-repeat: repeat;
            background-size: cover;

            opacity: 0.95;
        }
        
    </style>
</head>

<body>


    <div class="container px-xl-5">
        <div class="mx-xl-5">

            <div class="card mb-3 bg-slightly-transparent">
                <img class="card-img-top" src="./Header-No-Assets Al-Fath.jpg" alt="">

            </div>


            <form id="formulir" class="mb-3  needs-validation" novalidate>

                <div class="card mb-3 bg-slightly-transparent ">
                    <div class="d-flex justify-content-around align-items-center">
                        <img class="card-img-top d-block " alt="">

                        <!-- <img class="card-img-top d-block " src="LOGO WARNA.png"  style="width: 50px; height: auto;" alt="">
                <img class="card-img-top d-block " src="Rinai Hamaika.png"  style="width: 40px; height: auto;" alt=""> -->
                    </div>
                    <!--  -->
                    <div class="card-header">
                        <h1 class="text-center"> <b> ðŸ“°Pembuatan Berita Acara ðŸ“°</b></h1>
                    </div>
                    <div class="card-body">
                        <p class="whitespace-pre-line ">
                            Assalamu'alaikum semuannya
                            gimana nih kabarnnya?

                            berhubung sudah banyak proker Al-Fath yang berjalan, kami dari sekretaris umum memerlukan
                            laporan kegiatan apa saja yang sudah bejalan selama kepengurusan Al-Fath ini.

                            Oleh karena itu, kami mewajibkan pembuatan berita acara untuk setiap kegiatan yang
                            berlangsung.

                            Berita acara adalah laporan berjalannya/berlangsungnya sebuah kegiatan.

                            Berita acara dibuat tepat pada hari-H pelaksanaan sebuah acara.

                            ðŸ“ŒTEKNIS PEMBUATAN BERITA ACARAðŸ“Œ
                            untuk mempermudah pembuatan berita acara, kami membuat google form untuk menginputkan
                            data-data yang diperlukan dalam dokumen berita acara. Yang kemudian setelah melakukan submit
                            form, maka dokumen berita acara akan dibuat secara otomatis berdasarkan data yang
                            diinputkan.
                            Dokumen berita acara tersebut tetap dapat diedit sesuai kebutuhan.

                            https://bit.ly/pembuatanBeritaAcara_AlFathGen11
                            https://bit.ly/pembuatanBeritaAcara_AlFathGen11
                            https://bit.ly/pembuatanBeritaAcara_AlFathGen11

                            ðŸ“ŒðŸ“ŒðŸ“Œ
                            Note:
                            1. Berita acara diperuntukkan bagi kegiatan yang masuk kedalam Grand Design atau dan yang
                            melibatkan pihak eksternal (seperti kajian, workshop dll)
                            2. kegiatan yang bersifat rutinan (seperti berbagi takjil, ngajar ngaji) dibuatkan minimal
                            satu berita acara saja dengan ditambah penjelasan kalau acara ini bersifat rutin di dokumen
                            hasil berita acarannya
                            3. jika berita acara sudah selesai dibuat, silahkan buat shortcut file berita acarannya ke
                            folder drive departemen / fakultas masing-masing (jika diperlukan). Dengan tanpa memindahkan
                            file berita acara yang asli ke folder lain.
                        </p>




                    </div>
                    <div class="card-footer text-body-secondary">
                        <p class="text-danger">

                            * Jangan masukan data sensitif seperti password ke dalam formulir ini
                        </p>
                    </div>
                </div> <!-- card -->

                <!--Boostrapt Card -->
                <div class="card mb-3 bg-slightly-transparent">
                    <!-- <img class="card-img-top d-block text-center" src="LOGO WARNA.png"  style="width: 50px; height: auto;" alt=""> -->
                    <div class="card-body">
                        <h4 class="card-title">Step By Step</h4>
                        <p class="whitespace-pre-line">
                            Berikut template dari berita acara (jika ingin mengisi manual)
                            Template
                            Ketentuan:
                            1. Isi google form ini sesuai ketentuan & contoh yang ada di tiap pertanyaan (jika ada)
                            2. Setelah mengisi, cek email yang telah diinputkan pada google form untuk melihat hasil
                            berita
                            acarannya
                            3. Edit berita acara jika diperlukan

                            Folder hasil berita acara bisa diakses melalui link berikut
                        </p>
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-3" for="asal">
                            <h6> Asal Departemen / Fakultas</h6>
                        </label>
                        <br>
                        <div class="btn-group " role="group">
                            <select class="form-select" id="asal" name="asal" required>
                                <option value="">Silahkan Isi...</option>
                                <option value="FIF">FIF</option>
                                <option value="FRI">FRI</option>
                                <option value="FKB">FKB</option>
                                <option value="FEB">FEB</option>
                                <option value="FIK">FIK</option>
                                <option value="FTE">FTE</option>
                                <option value="FIT">FIT</option>
                                <option value="PSDM">PSDM</option>
                                <option value="KDRP">KDRP</option>
                                <option value="MEDKOM">MEDKOM</option>
                                <option value="SYIAR">SYIAR</option>
                                <option value="KEMUS">KEMUS</option>
                                <option value="EKSTERNAL">EKSTERNAL</option>
                                <option value="MO">MO</option>
                                <option value="BUSDEV">BUSDEV</option>
                                <option value="INTI">INTI</option>
                            </select>
                        </div>
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-3" for="email">
                            <h6> Email Pembuat Berita Acara
                            </h6>
                        </label>
                        <input type="email" name="email" id="email" required placeholder="Masukan Jawaban Kamu"
                            class="form-control" aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-3" for="nama_sekretaris">
                            <h6> Nama Sekretaris Kegiatan</h6>
                        </label>
                        <input type="text" name="nama_sekretaris" id="nama_sekretaris" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-3" for="nim_sekretaris">
                            <h6> NIM Sekretaris Kegiatan</h6>
                        </label>
                        <input type="number" name="nim_sekretaris" id="nim_sekretaris" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-3" for="nama_ketua_pelaksana">
                            <h6> Nama Ketua Pelaksana</h6>
                        </label>
                        <input type="text" name="nama_ketua_pelaksana" id="nama_ketua_pelaksana" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-3" for="nim_ketua_pelaksana">
                            <h6> NIM Ketua Pelaksana</h6>
                        </label>
                        <input type="number" name="nim_ketua_pelaksana" id="nim_ketua_pelaksana" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-3" for="nama_kepanitiaan">
                            <h6> Penyelenggara/Panitia Kegiatan</h6>
                        </label>
                        <p class="whitespace-pre-line">Jika ada nama kepanitiaan, gunakan nama kepanitiaan tersebut.
                            Jika
                            tidak ada, cukup dengan nama
                            departemen / bidang / fakultas penyelenggara
                            contoh:
                            - Panitia Islah 2022
                            - Departemen Kaderisasi
                            - Bidang Akademik Al-Fath FIF
                            - Panitia Prada
                            - Al-Fath FEB bersama dengan HIPMI</p>
                        <input type="text" name="nama_kepanitiaan" id="nama_kepanitiaan" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-1" for="nama_kegiatan">
                            <h6>Nama Kegiatan</h6>
                        </label>
                        <p class="whitespace-pre-line">Contoh: Big Class 2</p>
                        <input type="text" name="nama_kegiatan" id="nama_kegiatan" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>

                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-1" for="tanggal_lengkap_acara">
                            <h6>Tanggal Kegiatan</h6>
                        </label>
                        <p class="whitespace-pre-line">Keterangan: Tanggal disini berupa tanggal kegiatan dilaksanakan
                        </p>
                        <input type="date" name="tanggal_lengkap_acara" id="tanggal_lengkap_acara" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-1" for="jam_selesai">
                            <h6>Jam Kegiatan Selesai</h6>
                        </label>
                        <p class="whitespace-pre-line">Keterangan: Bisa berupa perkiraan selesai</p>
                        <input type="time" name="jam_selesai" id="jam_selesai" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-1" for="tempat">
                            <h6>Tempat Kegiatan </h6>
                        </label>
                        <p class="whitespace-pre-line">Contoh:
                            - Gedung Serba Guna (GSG)
                            - platform online (google meet)
                        </p>
                        <input type="text" name="tempat" id="tempat" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-1" for="jumlah_peserta">
                            <h6>Jumlah peserta </h6>
                        </label>
                        <p class="whitespace-pre-line">Kita tidak tahu pastinya, bisa perkiraan saja
                            contoh (pilih salah satu):
                            - 20 Peserta
                            - 19 Peserta & 5 Panitia
                            - sekitar 20 peserta
                            - Lebih dari 20 peserta
                        </p>
                        <input type="text" name="jumlah_peserta" id="jumlah_peserta" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-1" for="rangkaian_kegiatan">
                            <h6>Rangkaian Kegiatan </h6>
                        </label>
                        <p class="whitespace-pre-line">isinya berupa gambaran kasar kegiatannya
                            bisa disertai link realisasi rundown (optional)
                            Contoh:
                            Tilawah Al-Quran, penyampaian materi, tanya jawab dan games
                        </p>
                        <input type="text" name="rangkaian_kegiatan" id="rangkaian_kegiatan" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-1" for="dokumentasi">
                            <h6>Link Dokumentasi Kegiatan </h6>
                        </label>
                        <p class="whitespace-pre-line">bisa berupa link google drive yang berisi dokumentasi dari acara
                            tersebut
                        </p>
                        <input type="url" name="dokumentasi" id="dokumentasi" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body">
                        <label class="form-label mb-1" for="kota_pembuatan_surat">
                            <h6>Kota/Kabupaten Pelaksanaan Kegiatan </h6>
                        </label>
                        <p class="whitespace-pre-line">Contoh: Bandung
                        </p>
                        <input type="text" name="kota_pembuatan_surat" id="kota_pembuatan_surat" required
                            placeholder="Masukan Jawaban Kamu" class="form-control"
                            aria-describedby="Masukan data dengan benar">
                    </div>
                </div>
                <input type="hidden" id="latitude" name="latitude">
                <input type="hidden" id="longitude" name="longitude">
                <div class="card mb-3 bg-slightly-transparent">
                    <div class="card-body  ">

                        <button type="submit" class="btn btn-outline-primary ">Submit</button>

                        <p class="text-muted">Ucapkan Basmallah sebelum kelakukan submit</p>
                    </div>
                </div>

            </form>


            <footer class="card mb-3 bg-slightly-transparent">
                <div class="card-footer text-muted">
                    <div class="row">
                        <div class="col-md-4 ">
                            <p><strong>Posisi:</strong> <span id="current-location"></span></p>
                        </div>
                        <div class="col-md-4">
                            <p> <span id="current-time"></span></p>
                        </div>
                        <div class="col-md-4">
                            <p><strong>Deadline:</strong> <span id="deadline"></span></p>
                        </div>
                    </div>
                    <p class="text-center">ðŸ“° Pembuatan Berita Acara LDK Al-Fath 2024 ðŸ“°</p>
                    <h6 class="text-muted text-center "> <a href="https://www.instagram.com/alfathtelu/"> LDK Al-Fath
                            Telkom
                            University Gen 11</a></h6>


                    <p class="text-muted text-center  opacity-25"> <a
                            href="https://chat.whatsapp.com/JG8CV0Q5I7yGzONuZT40Pg"><i class="bi bi-code-slash"></i></a>
                    </p>
                </div>


            </footer>
            <!-- create a success card -->
        </div>

    </div> <!-- container -->

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>
    <script>
        const deadline = "2024-08-09T23:59:59+07:00";
        const formulir = document.getElementById('formulir');
        setInterval(updateCurrentTime, 1000);

        function setDeadline(deadline) {
            const deadlineDate = new Date(deadline);
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: 'numeric', minute: 'numeric', second: 'numeric', timeZoneName: 'short' };
            document.getElementById('deadline').textContent = deadlineDate.toLocaleString('id-ID', options);


        }
        function updateCurrentTime() {
            const options = { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric', hour: 'numeric', minute: 'numeric', second: 'numeric', timeZoneName: 'short' };
            const currentTime = new Date().toLocaleString('id-ID', options);

            document.getElementById('current-time').textContent = currentTime;
        }


        function updateLocation() {
            
            if (navigator.geolocation) {
                console.log("coba" + navigator.geolocation);
                navigator.geolocation.getCurrentPosition((position) => {
                    const { latitude, longitude } = position.coords;
                    document.getElementById('current-location').textContent = `${latitude.toFixed(6)}, ${longitude.toFixed(6)}`;
                    document.getElementById('latitude').value = latitude;
                    document.getElementById('longitude').value = longitude;
                }, (error) => {
                    console.info('Error:', error);
                    document.getElementById('current-location').textContent = 'Not available' 
                });
            } else {
                document.getElementById('current-location').textContent = 'Not supported';
            }
        }
        // Load cached data
        window.addEventListener('load', () => {
         
            setDeadline(deadline);
            updateLocation();

            const cachedData = localStorage.getItem('formData');
            console.log(cachedData);
            if (cachedData) {
                const data = JSON.parse(cachedData);
                Object.entries(data).forEach(([key, value]) => {
                    const element = formulir.elements[key];
                    if (element) {
                        if (element.type === 'checkbox') {
                            element.checked = value.includes(element.value);
                        } else if (element.type === 'radio') {
                            element.checked = (element.value === value);
                        } else if (element.type !== 'file') {
                            element.value = value;
                        }
                    }
                });
            }
        });
        formulir.addEventListener('submit', async (event) => {
            console.log('formul ir ' + formulir.checkValidity());
            event.preventDefault();
            if (formulir.checkValidity()) {
                changeSubmitToLoading();
                const formData = new FormData(formulir);
                const data = Object.fromEntries(formData);
                localStorage.setItem('formData', JSON.stringify(data));
                data.interests = formData.getAll('interests');
                const {row, receivedData} = await sendToSpreadsheet(data);
                if (row){
                    showSuccessSendForm(row, receivedData);

                }else{
                    alert('Gagal mengirimkan formulir');
                    location.reload(true);
                    

                }
            } else {

                formulir.classList.add('was-validated');

            }
        });
        function changeSubmitToLoading() {
            const submitButton = document.querySelector('button[type="submit"]');
            submitButton.disabled = true;
            submitButton.classList.add('disabled');
            submitButton.className = 'btn btn-primary loading-button';
            submitButton.innerHTML =
                `
  <span class="spinner-grow spinner-grow-sm" aria-hidden="true"></span>
  <span role="status">Loading...</span>
        `;

        }
        

        function showSuccessSendForm(lastrow, receivedData = "") {
            formulir.innerHTML =
                `
        <div class="card mb-3 bg-slightly-transparent">
                            <div class="card-body">

            <div class="text-center">
                <h1 class="display-4 text-success">Alhamdulillah</h1>
                <p class="lead">Formulir anda berhasil tersimpan pada baris ke - ${lastrow}</p>
                <div class="mt-4">
 <a href="${receivedData}" class="btn btn-success" >Hasil</a>
                    <!-- Optional: Add more buttons or links as needed -->
                </div>
            </div>
            </div>
        </div>
        `
        }
        async function sendToSpreadsheet(data) {
            try {
                const response = await fetch('https://script.google.com/macros/s/AKfycbyHZfNDREu_41k7WTyZWL3g6t3tB5tgtYEGGjFMVwRb2aHhgXTyOBArtNn0v7pBGycOKA/exec?externalEntity=web', {

                    method: 'POST',
                    redirect: 'follow',

                    headers: {
                        'Content-Type': 'text/plain'

                    },

                    body: JSON.stringify(data),
                });
                console.log("aaw")
                if (response.ok) {
                    const result = await response.json();
                    localStorage.setItem('formData', JSON.stringify(data));
                    console.info(result) 
                    console.log('Success:' + result.row);
                    return result;


                } else {
                    throw new Error('Form submission failed');
                }
            } catch (error) {
                console.error('Error:', error);
            } finally {
            }
        }


    </script>

</body>

</html>
